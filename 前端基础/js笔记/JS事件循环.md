# JS事件循环

https://juejin.cn/post/6844903919789801486

### 一、渲染进程（浏览器内核）

渲染进程是一个多线程，包含以下线程：

- GUI渲染线程

- JS引擎线程

- 事件触发线程

- 定时器触发线程

- 异步网络请求线程

JS 本身是单线程的，但是又可以同时执行异步任务，所以JS的事件循环机制是通过在其他线程的帮助下，通过线程的通信来完成的。
### 二、事件循环机制
- JS分为同步任务和异步任务
- 同步任务一般在执行栈上运行，异步任务一般在其他线程上运行
- 异步任务执行完，就会被加入到事件触发线程的执行队列中
- 执行栈中的同步任务执行完，就会去找执行队列中的任务执行

### 三、宏任务和微任务

1. 什么是宏任务？

   每一次执行栈中执行的代码当做是一个宏任务，每一个宏任务执行完到下一个宏任务执行开始，都会调用GUI渲染进程开始工作。如主代码，还有setTimeout 和 setInterval等都是宏任务

2. 什么是微任务？
   在宏任务执行完之前，GUI渲染进程执行之前，会调用微任务	
   
3. 如何进行事件循环：
   - 执行一个宏任务，如果执行过程中遇到微任务，就把它添加到微任务队列，遇到宏任务就把 它添加到宏任务队列。
   - 每次一个宏任务队列执行完，就需将所有微任务队列中的任务执行完（微任务中产生微任务，继续加到微任务队列，微任务中产生宏任务，添加到宏任务队列）
   - 所有微任务执行完后，就开始GUI渲染
   - GUI渲染完成，则开始下一个宏任务
   - 如此循环
   
   ,